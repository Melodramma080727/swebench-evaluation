{"instance_id": "astropy__astropy-12907", "model_name_or_path": "claude-sonnet-4-20250514", "model_patch": "diff --git a/astropy/modeling/separable.py b/astropy/modeling/separable.py\n--- a/astropy/modeling/separable.py\n+++ b/astropy/modeling/separable.py\n@@ -288,7 +288,7 @@ def _separable(transform):\n         separable_matrix = _cstack(transform)\n     elif isinstance(transform, CompoundModel):\n         if isinstance(transform, Model):\n-            separable_matrix = _separable(transform)\n+            separable_matrix = _coord_matrix(transform, 'left', transform.n_outputs)\n         else:\n             separable_matrix = _separable(transform.left) & _separable(transform.right)\n     else:"}
{"instance_id": "astropy__astropy-14182", "model_name_or_path": "claude-sonnet-4-20250514", "model_patch": "diff --git a/astropy/io/ascii/rst.py b/astropy/io/ascii/rst.py\n--- a/astropy/io/ascii/rst.py\n+++ b/astropy/io/ascii/rst.py\n@@ -10,7 +10,7 @@ from . import fixedwidth\n \n \n class RST(fixedwidth.FixedWidth):\n-    \"\"\"reStructuredText simple format table.\n+    \"\"\"reStructuredText simple format table with support for multi-line headers.\n \n     See: https://docutils.sourceforge.io/docs/ref/rst/restructuredtext.html#simple-tables\n \n@@ -18,6 +18,7 @@ class RST(fixedwidth.FixedWidth):\n     \"\"\"\n \n     data_class = fixedwidth.FixedWidthData\n+    header_class = fixedwidth.FixedWidthHeader\n \n     def __init__(self, header_rows=None):\n         super().__init__(delimiter_pad=None, bookend=False)\n@@ -25,6 +26,7 @@ class RST(fixedwidth.FixedWidth):\n \n     def write(self, lines):\n         lines = super().write(lines)\n+        header_rows = getattr(self, 'header_rows', None)\n         idx = None\n         for i, line in enumerate(lines):\n             if line.startswith('---'):\n@@ -32,6 +34,15 @@ class RST(fixedwidth.FixedWidth):\n                 break\n         if idx is not None:\n             lines = lines[idx:]\n+            # Handle multi-line headers\n+            if header_rows and len(header_rows) > 1:\n+                # Find the position after the first header separator\n+                sep_idx = 0\n+                for i, line in enumerate(lines):\n+                    if line.startswith('==='):\n+                        sep_idx = i + 1\n+                        break\n+                # The header content is already handled by the parent class\n         for i, line in enumerate(lines):\n             if line.startswith('---'):\n                 lines[i] = re.sub(r'-', '=', line)"}
{"instance_id": "astropy__astropy-14365", "model_name_or_path": "claude-sonnet-4-20250514", "model_patch": "diff --git a/astropy/io/ascii/qdp.py b/astropy/io/ascii/qdp.py\n--- a/astropy/io/ascii/qdp.py\n+++ b/astropy/io/ascii/qdp.py\n@@ -80,7 +80,7 @@ def _line_type(line, delimiter=None):\n     _decimal_re = r\"[+-]?(\\d+(\\.\\d*)?|\\.\\d+)([eE][+-]?\\d+)?\"\n     _command_re = r\"READ [TS]ERR(\\s+[0-9]+)+\"\n \n-    if re.match(_command_re, line):\n+    if re.match(_command_re, line, re.IGNORECASE):\n         return \"command\"\n     elif line.lstrip().startswith(\"!\"):\n         return \"comment\""}
